(p=>{var c,i=window.console||{log:function(){}},n=window.URL||window.webkitURL,s=p("#image"),l=p("#download"),a=p("#dataX"),t=p("#dataY"),o=p("#dataHeight"),r=p("#dataWidth"),d=p("#dataRotate"),v=p("#dataScaleX"),h=p("#dataScaleY"),g={aspectRatio:16/9,preview:".img-preview",crop:function(e){a.val(Math.round(e.detail.x)),t.val(Math.round(e.detail.y)),o.val(Math.round(e.detail.height)),r.val(Math.round(e.detail.width)),d.val(e.detail.rotate),v.val(e.detail.scaleX),h.val(e.detail.scaleY)}},m=s.attr("src"),u="cropped.jpg",f="image/jpeg",b=(s.on({ready:function(e){i.log(e.type)},cropstart:function(e){i.log(e.type,e.detail.action)},cropmove:function(e){i.log(e.type,e.detail.action)},cropend:function(e){i.log(e.type,e.detail.action)},crop:function(e){i.log(e.type)},zoom:function(e){i.log(e.type,e.detail.ratio)}}).cropper(g),p.isFunction(document.createElement("canvas").getContext)||p('button[data-method="getCroppedCanvas"]').prop("disabled",!0),void 0===document.createElement("cropper").style.transition&&(p('button[data-method="rotate"]').prop("disabled",!0),p('button[data-method="scale"]').prop("disabled",!0)),void 0===l[0].download&&l.addClass("disabled"),p(".docs-toggles").on("change","input",function(){var e,a,t=p(this),o=t.attr("name"),r=t.prop("type");s.data("cropper")&&("checkbox"===r?(g[o]=t.prop("checked"),e=s.cropper("getCropBoxData"),a=s.cropper("getCanvasData"),g.ready=function(){s.cropper("setCropBoxData",e),s.cropper("setCanvasData",a)}):"radio"===r&&(g[o]=t.val()),s.cropper("destroy").cropper(g))}),p(".docs-buttons").on("click","[data-method]",function(){var e,a,t,o=p(this),r=o.data(),d=s.data("cropper");if(!o.prop("disabled")&&!o.hasClass("disabled")&&d&&r.method){if(void 0!==(r=p.extend({},r)).target&&(a=p(r.target),void 0===r.option))try{r.option=JSON.parse(a.val())}catch(e){i.log(e.message)}switch(e=d.cropped,r.method){case"rotate":e&&0<g.viewMode&&s.cropper("clear");break;case"getCroppedCanvas":"image/jpeg"===f&&(r.option||(r.option={}),r.option.fillColor="#fff")}switch(t=s.cropper(r.method,r.option,r.secondOption),r.method){case"rotate":e&&0<g.viewMode&&s.cropper("crop");break;case"scaleX":case"scaleY":p(this).data("option",-r.option);break;case"getCroppedCanvas":t&&(p("#getCroppedCanvasModal").modal().find(".modal-body").html(t),l.hasClass("disabled")||(download.download=u,l.attr("href",t.toDataURL(f))));break;case"destroy":c&&(n.revokeObjectURL(c),c="",s.attr("src",m))}if(p.isPlainObject(t)&&a)try{a.val(JSON.stringify(t))}catch(e){i.log(e.message)}}}),p(document.body).on("keydown",function(e){if(e.target===this&&s.data("cropper")&&!(300<this.scrollTop))switch(e.which){case 37:e.preventDefault(),s.cropper("move",-1,0);break;case 38:e.preventDefault(),s.cropper("move",0,-1);break;case 39:e.preventDefault(),s.cropper("move",1,0);break;case 40:e.preventDefault(),s.cropper("move",0,1)}}),p("#inputImage"));n?b.change(function(){var e=this.files;s.data("cropper")&&e&&e.length&&(e=e[0],/^image\/\w+$/.test(e.type)?(u=e.name,f=e.type,c&&n.revokeObjectURL(c),c=n.createObjectURL(e),s.cropper("destroy").attr("src",c).cropper(g),b.val("")):window.alert("Please choose an image file."))}):b.prop("disabled",!0).parent().addClass("disabled")})(jQuery);